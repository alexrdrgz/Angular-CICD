version: 2.1
jobs:
  test:
    working_directory: ~/repo/angular-project
    docker:
      - image: cimg/node:14.10.1 # the primary container, where your job's commands are run
        auth:
          username: mydockerhub-user
          password: $DOCKERHUB_PASSWORD  # context / project UI env-var reference
    steps:
      - checkout: # check out the code in the project directory
          path: ~/repo/angular-project
      # look for existing cache and restore if found
      - run:
          name: install dependencies
          command: |
            cd angular-project
            sudo npm install
            sudo npm install angular-cli@latest -g
      # save any changes to the cache
      - run:
          name: Test Application
          command: |-
            ng test --watch=false


workflows:
  version: 2
  build-and-test:
    jobs:
      - test